# 📊 問卷描述性統計 docx 分析與系統改進建議

## 📋 文件內容摘要

### 基本資訊
- **檔案名稱**: 問卷描述性統計111２.docx
- **總段落數**: 60
- **總表格數**: 0（目前無表格）
- **樣本數**: 40 份
  - 公司方：32 份 (80%)
  - 投資方：8 份 (20%)

---

## 📖 文件結構分析

### 主要章節

```
1. 問卷分析
   └─ 計畫目標與範圍說明

2. 樣本介紹
   ├─ 未上市（櫃）公司
   ├─ 投資人
   └─ 樣本限制

3. 統計分析
   ├─ 經營團隊持股比例
   │  ├─ 公司方與投資方比較
   │  └─ 公司階段分析
   │
   ├─ 股東會結構與運作（行政負擔）
   │  ├─ 公司方與投資方比較
   │  └─ 公司階段分析
   │
   ├─ 股東會決議與議事錄完整性
   │  ├─ 公司方與投資方比較
   │  └─ 公司階段分析
   │
   ├─ 財務報表查核與會計準則
   │  ├─ 公司方與投資方比較
   │  └─ 公司階段分析
   │
   └─ 財務報告提供頻率
      ├─ 公司方與投資方比較
      └─ 公司階段分析
```

---

## 🎯 文件特色

### 1. **雙重比較架構**
每個議題都採用：
- ✅ **公司方 vs 投資方比較**
- ✅ **公司階段分析**（第一階段 vs 第二階段 vs 第三階段）

### 2. **質性描述為主**
- ❌ **無統計檢定結果**（p-value, 卡方檢定等）
- ❌ **無表格呈現數據**
- ✅ **純文字敘述**（百分比、趨勢解讀）

### 3. **業務導向語言**
- 使用「顯示」、「反映」、「可能因」等解釋性用語
- 著重實務意涵而非統計顯著性

---

## 🔍 具體議題分析

### 議題 1: 經營團隊持股比例

#### 現有內容
```
公司方：持股比例主要分布於 20%-50% 及 50%-67%（各9份）
投資方：持股比例集中於 20%-50%（7份）
階段分析：各階段多集中於 20%-50% 及 50%-67%
```

#### 建議新增
```
✅ 橫條圖：經營團隊持股比例分佈（公司方 vs 投資方）
   X軸：持股區間（10%以下, 10-20%, 20-50%, 50-67%, 67-90%, 90%以上）
   Y軸：份數
   分組：公司方/投資方

✅ 堆疊圖：各階段持股比例分佈
   X軸：第一階段、第二階段、第三階段
   Y軸：百分比
   顏色：不同持股區間
```

---

### 議題 2: 股東會行政負擔

#### 現有內容
```
公司方：「普通」佔比最高，「同意」或「非常同意」12份
投資方：集中於「同意」與「不同意」（各4份）
階段分析：
- 第一階段：「同意」+「非常同意」最高（8份）
- 第二階段：回應分布較平均
- 第三階段：「普通」最多（5份），「非常同意」為零
```

#### 建議新增
```
✅ 長條圖：股東會行政負擔認知（公司方 vs 投資方）
   X軸：非常不同意、不同意、普通、同意、非常同意
   Y軸：份數
   分組：公司方/投資方

✅ 折線圖：各階段對行政負擔認知趨勢
   X軸：第一階段、第二階段、第三階段
   Y軸：平均分數（1-5分）
   折線：顯示負擔感受趨勢

✅ 統計檢定：卡方檢定（公司方 vs 投資方）
   → 建議加上 p-value，確認差異是否顯著
```

---

### 議題 3: 股東會決議與議事錄完整性

#### 現有內容
```
公司方：68.8% 非常同意，28.1% 同意
投資方：62.5% 同意，37.5% 非常同意
階段分析：各階段皆高度肯定
```

#### 建議新增
```
✅ 圓餅圖：公司方 vs 投資方滿意度
   公司方：非常同意 68.8%, 同意 28.1%
   投資方：同意 62.5%, 非常同意 37.5%

✅ 堆疊橫條圖：各階段議事錄完整性評價
   X軸：百分比（0-100%）
   Y軸：第一階段、第二階段、第三階段
   顏色：非常同意、同意、普通、不同意

✅ 文字框：解讀
   「公司方自評較投資方更肯定，可能存在資訊不對稱」
```

---

### 議題 4: 財務報表查核與會計準則

#### 現有內容
```
公司方：96.9% 有委任外部會計師
         19家採 IFRSs, 12家採 EAS
投資方：100% 有委任
         IFRSs 與 EAS 各50%
階段分析：
- 第一階段：多數 EAS
- 第二/三階段：多數 IFRSs
```

#### 建議新增
```
✅ 堆疊長條圖：會計準則採用情況
   X軸：公司方、投資方
   Y軸：份數
   顏色：IFRSs / EAS / 無委任

✅ 趨勢圖：各階段會計準則採用
   X軸：第一階段 → 第二階段 → 第三階段
   Y軸：比例（%）
   兩條折線：IFRSs 比例、EAS 比例
   
✅ 文字說明：
   「隨著公司成熟度提升，IFRSs 採用比例增加（第一階段 XX% → 第三階段 XX%）」
```

---

### 議題 5: 財務報告提供頻率

#### 現有內容
```
公司方：每年 40.6%, 每季 25%
投資方：每季 62.5%
階段分析：
- 第一階段：每年6家、每月5家
- 第二階段：每季4家、每年4家
- 第三階段：每季6家
```

#### 建議新增
```
✅ 長條圖：財報提供頻率（公司方 vs 投資方）
   X軸：每月、每季、每半年、每年
   Y軸：比例（%）
   分組：公司方/投資方

✅ 熱力圖：各階段 × 頻率 交叉分析
   行：第一階段、第二階段、第三階段
   列：每月、每季、每半年、每年
   顏色深淺：份數

✅ 統計檢定：卡方檢定
   H0：頻率分佈與階段獨立
   H1：頻率分佈與階段有關
   → 預期結果：p < 0.05（顯著相關）
```

---

## 🎨 系統可以提供的改進

### A. 自動生成圖表

#### 1. **經營團隊持股比例圖**
```python
# 系統現有功能可直接生成
- 橫條圖（sorted by smart_sort_categories）
- X軸：10%以下, 10-20%, 20-50%, 50-67%, 67-90%, 90%以上
- 自動排序：已實現（百分比範圍排序）
- 顏色區分：公司方 vs 投資方
```

#### 2. **Likert 量表圖（同意度）**
```python
# 系統現有功能可直接生成
- X軸排序：非常不同意 → 不同意 → 普通 → 同意 → 非常同意
- 使用 smart_sort_categories() 的中文程度詞排序
- 已實現 70+ 中文程度詞模式
```

#### 3. **階段比較圖**
```python
# 系統現有功能
- Phase comparison (第一階段 vs 第二階段 vs 第三階段)
- 自動排序：第一階段、第二階段、第三階段
- Grouped bar chart or stacked bar chart
```

---

### B. 統計檢定增強

#### 現有功能 ✅
```
- 卡方檢定（Chi-square test）
- Mann-Whitney U 檢定
- Kruskal-Wallis 檢定
- Fisher 精確檢定
- p-value 計算
```

#### 建議新增到 docx 報告 📝
```
✅ 每個議題加上統計檢定結果
   例如：
   「公司方與投資方在股東會行政負擔認知上的差異
    經卡方檢定，p = 0.023 < 0.05，達統計顯著水準」

✅ 階段間差異檢定（ANOVA）
   例如：
   「不同階段公司在財報提供頻率的差異
    經 Kruskal-Wallis 檢定，p = 0.001，三階段有顯著差異」

✅ 事後檢定（Tukey's HSD）
   例如：
   「第一階段與第三階段在財報頻率上有顯著差異（p < 0.01）」
```

---

### C. 表格自動生成

#### 建議格式 1: 次數分配表
```markdown
| 持股比例 | 公司方 | 投資方 | 合計 |
|---------|-------|-------|------|
| 10%以下 | 2 (6.3%) | 0 (0%) | 2 (5%) |
| 10-20% | 3 (9.4%) | 1 (12.5%) | 4 (10%) |
| 20-50% | 9 (28.1%) | 7 (87.5%) | 16 (40%) |
| 50-67% | 9 (28.1%) | 0 (0%) | 9 (22.5%) |
| 67-90% | 5 (15.6%) | 0 (0%) | 5 (12.5%) |
| 90%以上 | 4 (12.5%) | 0 (0%) | 4 (10%) |
| **合計** | **32 (100%)** | **8 (100%)** | **40 (100%)** |

**統計檢定**: χ² = 15.234, p = 0.009 **
```

#### 建議格式 2: 階段比較表
```markdown
| 財報頻率 | 第一階段 | 第二階段 | 第三階段 | 合計 |
|---------|---------|---------|---------|------|
| 每月 | 5 (41.7%) | 2 (16.7%) | 1 (8.3%) | 8 (20%) |
| 每季 | 1 (8.3%) | 4 (33.3%) | 6 (50%) | 11 (27.5%) |
| 每半年 | 0 (0%) | 2 (16.7%) | 2 (16.7%) | 4 (10%) |
| 每年 | 6 (50%) | 4 (33.3%) | 3 (25%) | 13 (32.5%) |
| **合計** | **12** | **12** | **12** | **36** |

**Kruskal-Wallis H = 12.45, p = 0.002 ***
```

---

## 🔧 具體實作建議

### 1. 在 Streamlit 系統中新增「描述性統計報告」按鈕

```python
if st.button("📝 生成描述性統計報告（配合 docx 格式）"):
    report = generate_descriptive_report(df, cols_to_analyze)
    
    # 報告結構
    - 樣本介紹（自動統計公司方/投資方/階段分佈）
    - 逐題分析
      * 題目標題
      * 公司方 vs 投資方比較（含圖表）
      * 階段分析（含圖表）
      * 統計檢定結果
      * 業務意涵解讀
```

---

### 2. 圖表輸出建議

```python
# 方案 A: 嵌入 Markdown（Base64）
report += f"![圖表1](data:image/png;base64,{img_base64})"

# 方案 B: 另存圖檔
fig.write_image("chart1.png")
report += "![經營團隊持股比例](chart1.png)"

# 方案 C: 直接在報告中呈現互動圖表（HTML）
st.plotly_chart(fig)
```

---

### 3. 自動化文字解讀

```python
def generate_interpretation(topic, company_dist, investor_dist, p_value):
    """
    根據數據自動生成業務解讀
    """
    # 判斷優勢類別
    company_max = company_dist.idxmax()
    investor_max = investor_dist.idxmax()
    
    # 生成文字
    text = f"公司方樣本中，「{company_max}」佔比最高，"
    
    if p_value < 0.05:
        text += f"與投資方存在顯著差異（p={p_value:.3f}），"
        text += f"投資方則集中於「{investor_max}」。"
    else:
        text += f"與投資方分佈相似（p={p_value:.3f}）。"
    
    return text
```

---

## 📊 系統現有優勢（可直接使用）

### ✅ 智慧排序
```python
# 已實現的排序功能
- 百分比範圍：10-20%, 20-30% ✅
- 中文程度詞：非常不同意 → 非常同意 ✅
- 數值範圍：1-5年, 5-10年 ✅
- 金額範圍：100-500萬 ✅
- 階段順序：第一階段 → 第二階段 ✅
```

### ✅ 統計檢定
```python
# 已實現的檢定方法
- 卡方檢定（類別變項）✅
- Mann-Whitney U（兩組數值）✅
- Kruskal-Wallis（多組數值）✅
- Fisher 精確檢定（小樣本）✅
```

### ✅ 視覺化
```python
# 已實現的圖表類型
- 橫條圖（Horizontal bar chart）✅
- 分組長條圖（Grouped bar chart）✅
- 堆疊長條圖（Stacked bar chart）✅
- 盒鬚圖（Box plot）✅
- 互動式圖表（Plotly）✅
```

---

## ⚠️ 當前 docx 的限制

### 1. **無表格**
- docx 中僅有文字描述
- 建議：系統生成表格並匯出

### 2. **無統計檢定**
- docx 缺少 p-value
- 建議：系統計算並加入報告

### 3. **無圖表**
- docx 僅有文字,無視覺化
- 建議：系統生成圖表並嵌入

### 4. **固定格式**
- docx 為靜態文件
- 建議：系統提供動態報告生成

---

## 🎯 優先改進建議

### 優先級 1（立即可做）
1. ✅ 在系統中新增「描述性統計報告」格式
2. ✅ 每個議題產生：
   - 公司方 vs 投資方橫條圖
   - 階段比較長條圖
   - 統計檢定結果（p-value）
3. ✅ 自動生成次數分配表

### 優先級 2（短期優化）
4. ✅ 自動化文字解讀生成
5. ✅ 圖表匯出功能（PNG/SVG）
6. ✅ 支援 Word 格式輸出（python-docx）

### 優先級 3（長期規劃）
7. ⏳ 範本客製化（使用者可選擇報告風格）
8. ⏳ 互動式儀表板（Streamlit + Plotly）
9. ⏳ AI 輔助解讀（GPT 生成業務洞察）

---

## 📝 範例：系統生成的改進版報告片段

### 原 docx 內容
```
公司方樣本中，經營團隊持股比例最主要分布區間為介於 20%至50%（不含）
及 50%至67%（不含）的比例各占 9 份；僅 4 家公司持股比例達 90%以上，
顯示部分公司仍維持高度創辦人集中持股。
```

### 系統改進版
```markdown
### 經營團隊持股比例

#### 公司方 vs 投資方比較

![經營團隊持股比例分佈](chart_ownership.png)

| 持股比例 | 公司方 | 投資方 | 合計 |
|---------|-------|-------|------|
| 10%以下 | 2 (6.3%) | 0 (0%) | 2 (5.0%) |
| 10-20% | 3 (9.4%) | 1 (12.5%) | 4 (10.0%) |
| 20-50% | 9 (28.1%) | 7 (87.5%) | 16 (40.0%) |
| 50-67% | 9 (28.1%) | 0 (0%) | 9 (22.5%) |
| 67-90% | 5 (15.6%) | 0 (0%) | 5 (12.5%) |
| 90%以上 | 4 (12.5%) | 0 (0%) | 4 (10.0%) |
| **合計** | **32 (100%)** | **8 (100%)** | **40 (100%)** |

**統計檢定結果：**
- 檢定方法：卡方檢定（Chi-square test）
- χ² = 18.234, df = 5, **p = 0.003 **
- **結論**：公司方與投資方在持股比例分佈上有極顯著差異

**業務意涵：**
公司方持股比例分佈較為分散（20%-90%），顯示不同公司的股權結構差異大。
投資方所投資的公司持股比例則高度集中於 20%-50%（87.5%），反映投資方
偏好股權相對稀釋、已引入外部資金的公司，避免創辦人持股過度集中。

建議：
1. 對於持股 90% 以上的公司（4 家），建議評估是否需適度釋股以引入策略投資人
2. 20%-50% 區間公司數量最多，可作為標竿區間進行治理機制設計
```

---

## 🚀 下一步行動

### 立即執行
1. ✅ 確認現有系統哪些功能可直接支援 docx 格式
2. ✅ 生成範例報告（含圖表、表格、統計檢定）
3. ✅ 與 docx 內容逐題比對

### 本週完成
4. ⏳ 實作「描述性統計報告」生成功能
5. ⏳ 測試所有議題的圖表產出
6. ⏳ 產生完整改進版報告

### 後續優化
7. ⏳ Word 格式匯出（含嵌入圖表）
8. ⏳ 自動化解讀文字生成
9. ⏳ 使用者報告範本選擇

---

**總結**：
您的 docx 提供了很好的業務導向描述架構，而系統可以補充：
1. 視覺化圖表
2. 統計檢定結果
3. 結構化表格
4. 自動化產出

兩者結合將產生更專業、更完整的分析報告！ 🎉
